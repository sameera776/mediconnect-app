{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import MedicineSearch from\"./MedicineSearch\";import{jwtDecode}from\"jwt-decode\";import MapView from\"./MapView\";import AdminInventory from\"./AdminInventory\";// âœ… Import admin section\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const[auth,setAuth]=useState(false);const[loading,setLoading]=useState(true);const[isAdmin,setIsAdmin]=useState(false);// âœ… Admin state\nuseEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){alert(\"You must be logged in to access the dashboard.\");window.location.href=\"/\";}else{try{const decoded=jwtDecode(token);console.log(\"Decoded token:\",decoded);// ðŸ‘ˆ ADD THIS LINE\nconst currentTime=Date.now()/1000;if(decoded.exp<currentTime){alert(\"Session expired. Please log in again.\");localStorage.removeItem(\"token\");window.location.href=\"/\";}else{setAuth(true);if(decoded.email===\"admin@gmail.com\"){setIsAdmin(true);}}}catch(err){console.error(\"Invalid token\",err);localStorage.removeItem(\"token\");window.location.href=\"/\";}}setLoading(false);},[]);const handleLogout=()=>{localStorage.removeItem(\"token\");alert(\"Logged out successfully.\");window.location.href=\"/\";};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return auth?/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to MediConnect Dashboard\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),/*#__PURE__*/_jsx(MedicineSearch,{}),/*#__PURE__*/_jsx(MapView,{}),isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(AdminInventory,{})]})]}):null;}export default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","MedicineSearch","jwtDecode","MapView","AdminInventory","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Dashboard","auth","setAuth","loading","setLoading","isAdmin","setIsAdmin","token","localStorage","getItem","alert","window","location","href","decoded","console","log","currentTime","Date","now","exp","removeItem","email","err","error","handleLogout","children","className","onClick"],"sources":["C:/Users/Uday Sameera/OneDrive/Desktop/MediConnect_JS/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport MedicineSearch from \"./MedicineSearch\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport MapView from \"./MapView\";\r\nimport AdminInventory from \"./AdminInventory\"; // âœ… Import admin section\r\n\r\nfunction Dashboard() {\r\n  const [auth, setAuth] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isAdmin, setIsAdmin] = useState(false); // âœ… Admin state\r\n\r\n  useEffect(() => {\r\n  const token = localStorage.getItem(\"token\");\r\n\r\n  if (!token) {\r\n    alert(\"You must be logged in to access the dashboard.\");\r\n    window.location.href = \"/\";\r\n  } else {\r\n    try {\r\n      const decoded = jwtDecode(token);\r\n      console.log(\"Decoded token:\", decoded);  // ðŸ‘ˆ ADD THIS LINE\r\n\r\n      const currentTime = Date.now() / 1000;\r\n      if (decoded.exp < currentTime) {\r\n        alert(\"Session expired. Please log in again.\");\r\n        localStorage.removeItem(\"token\");\r\n        window.location.href = \"/\";\r\n      } else {\r\n        setAuth(true);\r\n        if (decoded.email === \"admin@gmail.com\") {\r\n          setIsAdmin(true);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Invalid token\", err);\r\n      localStorage.removeItem(\"token\");\r\n      window.location.href = \"/\";\r\n    }\r\n  }\r\n\r\n  setLoading(false);\r\n}, []);\r\n\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    alert(\"Logged out successfully.\");\r\n    window.location.href = \"/\";\r\n  };\r\n\r\n  if (loading) return <p>Loading...</p>;\r\n\r\n  return auth ? (\r\n    <div className=\"container\">\r\n      <h2>Welcome to MediConnect Dashboard</h2>\r\n      <button onClick={handleLogout}>Logout</button>\r\n\r\n      <MedicineSearch />\r\n      <MapView />\r\n\r\n      {/* âœ… Show AdminInventory if user is admin */}\r\n      {isAdmin && (\r\n        <>\r\n          <hr />\r\n          <AdminInventory />\r\n        </>\r\n      )}\r\n    </div>\r\n  ) : null;\r\n}\r\n\r\nexport default Dashboard;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAC7C,OAASC,SAAS,KAAQ,YAAY,CACtC,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,QAAS,CAAAC,SAASA,CAAA,CAAG,CACnB,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CACvC,KAAM,CAACc,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACgB,OAAO,CAAEC,UAAU,CAAC,CAAGjB,QAAQ,CAAC,KAAK,CAAC,CAAE;AAE/CD,SAAS,CAAC,IAAM,CAChB,KAAM,CAAAmB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACVG,KAAK,CAAC,gDAAgD,CAAC,CACvDC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CAAC,IAAM,CACL,GAAI,CACF,KAAM,CAAAC,OAAO,CAAGvB,SAAS,CAACgB,KAAK,CAAC,CAChCQ,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEF,OAAO,CAAC,CAAG;AAEzC,KAAM,CAAAG,WAAW,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CACrC,GAAIL,OAAO,CAACM,GAAG,CAAGH,WAAW,CAAE,CAC7BP,KAAK,CAAC,uCAAuC,CAAC,CAC9CF,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC,CAChCV,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CAAC,IAAM,CACLX,OAAO,CAAC,IAAI,CAAC,CACb,GAAIY,OAAO,CAACQ,KAAK,GAAK,iBAAiB,CAAE,CACvChB,UAAU,CAAC,IAAI,CAAC,CAClB,CACF,CACF,CAAE,MAAOiB,GAAG,CAAE,CACZR,OAAO,CAACS,KAAK,CAAC,eAAe,CAAED,GAAG,CAAC,CACnCf,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC,CAChCV,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CACF,CAEAT,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAE,EAAE,CAAC,CAGJ,KAAM,CAAAqB,YAAY,CAAGA,CAAA,GAAM,CACzBjB,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC,CAChCX,KAAK,CAAC,0BAA0B,CAAC,CACjCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CAAC,CAED,GAAIV,OAAO,CAAE,mBAAOR,IAAA,MAAA+B,QAAA,CAAG,YAAU,CAAG,CAAC,CAErC,MAAO,CAAAzB,IAAI,cACTF,KAAA,QAAK4B,SAAS,CAAC,WAAW,CAAAD,QAAA,eACxB/B,IAAA,OAAA+B,QAAA,CAAI,kCAAgC,CAAI,CAAC,cACzC/B,IAAA,WAAQiC,OAAO,CAAEH,YAAa,CAAAC,QAAA,CAAC,QAAM,CAAQ,CAAC,cAE9C/B,IAAA,CAACL,cAAc,GAAE,CAAC,cAClBK,IAAA,CAACH,OAAO,GAAE,CAAC,CAGVa,OAAO,eACNN,KAAA,CAAAF,SAAA,EAAA6B,QAAA,eACE/B,IAAA,QAAK,CAAC,cACNA,IAAA,CAACF,cAAc,GAAE,CAAC,EAClB,CACH,EACE,CAAC,CACJ,IAAI,CACV,CAEA,cAAe,CAAAO,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}